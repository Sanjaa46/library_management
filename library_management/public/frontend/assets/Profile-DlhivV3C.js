var g=(w,n,o)=>new Promise((t,d)=>{var r=u=>{try{l(o.next(u))}catch(m){d(m)}},a=u=>{try{l(o.throw(u))}catch(m){d(m)}},l=u=>u.done?t(u.value):Promise.resolve(u.value).then(r,a);l((o=o.apply(w,n)).next())});import{_ as B,a as I}from"./Footer-CH4zAb_n.js";import{l as h,m as y,n as e,K as c,r as i,D as _,q as f,v as C,E as N,H as P,c as b,a as $,M as k,y as M,N as S,F as T}from"./index-BtVaK_ul.js";const F="/assets/library_management/frontend/assets/testpro-CJgdH1j7.jpeg",q={class:"pl-[20px] space-y-4"},D={__name:"ProfileInfo",props:{user:{type:Object,required:!0}},setup(w){const n=w;return(o,t)=>(y(),h("div",null,[t[5]||(t[5]=e("h1",{class:"pl-[20px] pb-[20px] text-[30px] font-bold"},"Info",-1)),e("ul",q,[e("li",null,[t[0]||(t[0]=e("p",{class:"text-black-overlay-500"},"ID",-1)),e("p",null,c(n.user.id),1)]),e("li",null,[t[1]||(t[1]=e("p",{class:"text-black-overlay-500"},"Firstname",-1)),e("p",null,c(n.user.first_name),1)]),e("li",null,[t[2]||(t[2]=e("p",{class:"text-black-overlay-500"},"Lastname",-1)),e("p",null,c(n.user.last_name),1)]),e("li",null,[t[3]||(t[3]=e("p",{class:"text-black-overlay-500"},"Email",-1)),e("p",null,c(n.user.email),1)]),e("li",null,[t[4]||(t[4]=e("p",{class:"text-black-overlay-500"},"Phone",-1)),e("p",null,c(n.user.phone),1)])])]))}},E={class:"pl-[30px]"},U={__name:"ChangePassword",setup(w){const n=i(""),o=i(""),t=i("");function d(){return g(this,null,function*(){if(n.value===o.value){alert("New password must be different!");return}if(o.value!==t.value){alert("Password did not match!");return}try{const l=yield(yield fetch("/api/method/library_management.api.change_password",{credentials:"include",method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({old_password:n.value,new_password:o.value})})).json();l.message.Success?alert("Password changed succesfully!"):(console.log(l),alert("Old password is incorrect!"))}catch(r){console.log("Change password failed: ",r),console.error("Error details:",{name:r.name,message:r.message,stack:r.stack}),alert("Change password failed. Please check console for details.")}})}return(r,a)=>{const l=_("Input"),u=_("Button"),m=_("Card");return y(),h("div",E,[f(m,{title:"Login to your FrappeUI App!",class:"z-10 rounded-xl"},{default:C(()=>[a[6]||(a[6]=e("h2",{class:"text-[30px] font-bold mb-8"},"Change Password",-1)),e("form",{class:"space-y-5",onSubmit:a[3]||(a[3]=N((...p)=>r.submit&&r.submit(...p),["prevent"]))},[f(l,{required:"",modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=p=>n.value=p),name:"current",type:"password",placeholder:"Current password",class:"w-[300px]"},null,8,["modelValue"]),f(l,{required:"",modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=p=>o.value=p),name:"password",type:"password",class:"w-[300px]",placeholder:"New password"},null,8,["modelValue"]),f(l,{required:"",modelValue:t.value,"onUpdate:modelValue":a[2]||(a[2]=p=>t.value=p),name:"password",type:"password",class:"w-[300px]",placeholder:"Re-enter new password"},null,8,["modelValue"]),a[5]||(a[5]=e("div",{class:"text-sm text-gray-500 cursor-pointer hover:underline"}," Forgot password? ",-1)),f(u,{onClick:d,variant:"solid",class:"bg-[#1290b9] text-white py-2 rounded hover:bg-[#016475] transition"},{default:C(()=>[...a[4]||(a[4]=[P(" Chnage Password ",-1)])]),_:1})],32)]),_:1})])}}},O={class:"flex max-w-[1120px] h-[550px] mx-auto my-15"},H={class:"w-[30%]"},J={class:"w-[50%] m-auto text-center text-[20px] font-bold"},z={class:"text-center"},A={class:"flex flex-col items-center space-y-3 mt-5"},L={class:"w-[70%]"},Q={__name:"Profile",setup(w){const n={ProfileInfo:D,ChangePassword:U},o=i("ProfileInfo"),t=b(()=>n[o.value]),d=i({}),r=i("John"),a=i("Doe"),l=i(!1),u=i(""),m=b(()=>l.value?"Membership":"Nonmembership"),p=b(()=>l.value?"text-green-700 bg-green-300":"text-red-700 bg-red-300"),V=b(()=>l.value?"opacity-0":"opacity-100");$(()=>g(this,null,function*(){try{const s=yield(yield fetch("/api/method/library_management.api.profile",{credentials:"include",method:"GET",headers:{"Content-Type":"application/json"}})).json();r.value=s.message.first_name,a.value=s.message.last_name,l.value=!1,d.value={id:s.message.id,first_name:s.message.first_name,last_name:s.message.last_name,phone:s.message.phone,email:s.message.email}}catch(x){console.error("Failed to fetch user info:",x)}}));function j(){return g(this,null,function*(){const v=yield(yield fetch("/api/method/library_management.api.create_checkout_session",{credentials:"include",method:"POST"})).json();console.log(v),u.value=v.message.url,window.href.replace(u)})}return(x,s)=>(y(),h(T,null,[f(B),s[6]||(s[6]=e("div",{class:"w-[1120px] my-8 mx-auto text-[24px] font-bold relative"},[e("div",{class:"absolute w-1 h-12 bg-[#118ab2] left-0"}),e("h1",{class:"text-4xl font-bold pl-5 pt-2"},"Profile")],-1)),e("section",O,[e("div",H,[e("a",{onClick:s[0]||(s[0]=v=>o.value="ProfileInfo")},[...s[2]||(s[2]=[e("div",{class:"w-[250px] h-[250px] mx-auto my-5 p-[7px] border-[3px] border-[#118ab2] rounded-full"},[e("img",{class:"m-auto w-[235px] h-[235px] object-fill rounded-[50%]",src:F,alt:"profile image"})],-1)])]),e("p",J,c(r.value+" "+a.value),1),e("div",{class:k(["w-[30%] m-auto rounded-full italic text-[10px]",p.value])},[e("p",z,[s[3]||(s[3]=e("b",null,"Status:",-1)),P(" "+c(m.value),1)])],2),e("div",A,[e("button",{onClick:j,class:k([" w-[215px] h-[35px] mt-5 bg-[#118ab2] hover:bg-[#016475] text-white-overlay-900 rounded-[10px]",V.value])}," Buy Membership ",2),e("button",{onClick:s[1]||(s[1]=v=>o.value="ChangePassword")}," Change Password > "),s[4]||(s[4]=e("button",null," My Books > ",-1))])]),s[5]||(s[5]=e("div",{class:"relative h-[475px] w-1 bg-[#118ab2] left-[-1px] top-[20px]"},null,-1)),e("div",L,[(y(),M(S(t.value),{user:d.value},null,8,["user"]))])]),f(I)],64))}};export{Q as default};
//# sourceMappingURL=Profile-DlhivV3C.js.map
