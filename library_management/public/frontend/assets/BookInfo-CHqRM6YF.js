var d=(v,c,t)=>new Promise((l,n)=>{var u=e=>{try{a(t.next(e))}catch(o){n(o)}},m=e=>{try{a(t.throw(e))}catch(o){n(o)}},a=e=>e.done?l(e.value):Promise.resolve(e.value).then(u,m);a((t=t.apply(v,c)).next())});import{_ as f,a as h}from"./Footer-DKP4t9lR.js";import{H as k,r as p,a as y,c as g,C as w,l as B,m as x,q as b,n as s,J as r,y as C,K as N,G as i,v as j,L as F,F as I}from"./index-Cf6cM8O6.js";const S={class:"h-[810px]"},$={class:"flex w-[1120px] p-[30px] mx-auto my-10"},V={class:"flex flex-col w-[20%] items-center justify-center"},q=["src"],D={class:"text-center mt-5"},H={class:"w-[80%] ml-10"},P={class:"text-[25px] font-medium"},T={class:"flex my-5 space-x-5 text-[15px]"},G={__name:"BookInfo",setup(v){const c=k(),t=p({}),l=p(""),n=p(!1);y(()=>d(this,null,function*(){l.value=c.query.article_name;const a=`/api/method/library_management.api.book_info?article_name=${l.value}`;try{const o=yield(yield fetch(a,{credentials:"include",method:"POST",body:{article_name:l.value}})).json();t.value=o.message}catch(e){console.error("Failed to fetch books: ",e)}try{const e=`/api/method/library_management.api.has_active_issue?book=${l.value}`,_=yield(yield fetch(e,{credentials:"include"})).json();console.log("Has active issue: ",_.message),n.value=_.message}catch(e){console.error("Failed to check the user have an active issue: ",e)}}));const u=g(()=>n.value?"opacity-0 cursor-not-allowed":"opacity-100");function m(){return d(this,null,function*(){const a=`/api/method/library_management.api.issue_book?book=${l.value}`;try{const o=yield(yield fetch(a,{credentials:"include"})).json();console.log("Issue book response: ",o.message),o.message.success||alert("You already requested this book!")}catch(e){console.error("Failed to issue the book: ",e),n.value=!1}})}return(a,e)=>{const o=w("Button");return x(),B(I,null,[b(f),s("div",S,[e[6]||(e[6]=s("div",{class:"w-[1120px] my-8 mx-auto text-[24px] font-bold relative"},[s("div",{class:"absolute w-1 h-12 bg-[#118ab2] left-0"}),s("h1",{class:"text-4xl font-bold pl-5 pt-2"},"Book Info")],-1)),s("section",$,[s("div",V,[s("img",{src:t.value.image,class:"w-[200px] h-[300px] object-contain rounded-[5px]",alt:"book image"},null,8,q),s("p",D,r(t.value.author),1)]),s("div",H,[s("h1",P,r(t.value.article_name),1),s("div",T,[s("p",null,[e[0]||(e[0]=s("b",null,"Author: ",-1)),i(r(t.value.author),1)]),s("p",null,[e[1]||(e[1]=s("b",null,"Publisher: ",-1)),i(r(t.value.publisher),1)]),s("p",null,[e[2]||(e[2]=s("b",null,"ISBN: ",-1)),i(r(t.value.isbn),1)]),s("p",null,[e[3]||(e[3]=s("b",null,"Status: ",-1)),i(r(t.value.status),1)])]),e[5]||(e[5]=s("h1",{class:"text-[18px] font-medium"},"Description",-1)),s("p",null,r(t.value.description),1),n.value?N("",!0):(x(),C(o,{key:0,onClick:m,variant:"solid",class:F(["bg-[#1290b9] w-[90px] text-white my-10 rounded hover:bg-[#016475] transition",u.value])},{default:j(()=>[...e[4]||(e[4]=[i(" Issue ",-1)])]),_:1},8,["class"]))])])]),b(h)],64)}}};export{G as default};
//# sourceMappingURL=BookInfo-CHqRM6YF.js.map
