{"version":3,"file":"BookInfo-CHqRM6YF.js","sources":["../../../../frontend/src/pages/BookInfo.vue"],"sourcesContent":["<template>\n<Header></Header>\n<div class=\"h-[810px] \">\n    <div class=\"w-[1120px] my-8 mx-auto text-[24px] font-bold relative\">\n        <div class=\"absolute w-1 h-12 bg-[#118ab2] left-0\"></div>\n        <h1 class=\"text-4xl font-bold pl-5 pt-2\">Book Info</h1>\n    </div>\n\n    <section  class=\"flex w-[1120px] p-[30px] mx-auto my-10\">\n        <!-- Book image and Author -->\n        <div class=\"flex flex-col w-[20%] items-center justify-center\">\n            <img :src=\"book.image\" class=\"w-[200px] h-[300px] object-contain rounded-[5px]\" alt=\"book image\">\n            <p class=\"text-center mt-5\">{{ book.author }}</p>\n        </div>\n\n        <!-- Book information -->\n        <div class=\"w-[80%] ml-10\">\n            <h1 class=\"text-[25px] font-medium\">{{ book.article_name }}</h1>\n            <div class=\"flex my-5 space-x-5 text-[15px]\">\n                <p><b>Author: </b>{{ book.author }}</p>\n                <p><b>Publisher: </b>{{ book.publisher }}</p>\n                <p><b>ISBN: </b>{{ book.isbn }}</p>\n                <p><b>Status: </b>{{ book.status }}</p>\n            </div>\n            <h1 class=\"text-[18px] font-medium\">Description</h1>\n            <p>\n                {{ book.description }}\n            </p>\n            <Button \n            v-if=\"!issueSuccess\"\n            @click=\"issueBook\" \n            variant=\"solid\" \n            :class='[\"bg-[#1290b9] w-[90px] text-white my-10 rounded hover:bg-[#016475] transition\", issueButtonClasses]'\n            >\n            Issue\n            </Button>\n        </div>\n    </section>\n</div>\n\n\n<Footer></Footer>\n</template>\n\n\n<script setup>\nimport Header from '../assets/components/Header.vue';\nimport Footer from '../assets/components/Footer.vue';\nimport { defineProps, ref, onMounted, computed } from 'vue';\nimport { useRoute } from 'vue-router';\n\nconst route = useRoute();\n\nconst book = ref({})\nconst articleName = ref(\"\")\nconst issueSuccess = ref(false)\n\nonMounted(async () => {\n    articleName.value = route.query.article_name;\n\n    const url = `/api/method/library_management.api.book_info?article_name=${articleName.value}`\n\n    // Fetch book info\n    try {\n        const response = await fetch(url, {\n            credentials: 'include',\n            method: 'POST',\n            body: {\n                article_name: articleName.value\n            }\n        });\n        const data = await response.json()\n\n        book.value = data.message\n    }\n    catch (error) {\n        console.error(\"Failed to fetch books: \", error);\n    }\n\n    // Check user have an active issue\n    try {\n        const check_issue_url = `/api/method/library_management.api.has_active_issue?book=${articleName.value}`\n        \n        const response = await fetch(check_issue_url, {\n            credentials: 'include'\n        })\n        const check_issue_data = await response.json();\n        console.log(\"Has active issue: \", check_issue_data.message)\n        issueSuccess.value = check_issue_data.message\n    } catch(error) {\n        console.error(\"Failed to check the user have an active issue: \", error)\n    }\n})\n\nconst issueButtonClasses = computed(() => {\n    return issueSuccess.value\n        ? \"opacity-0 cursor-not-allowed\"\n        : \"opacity-100\"\n})\n\nasync function issueBook() {\n\n    const url = `/api/method/library_management.api.issue_book?book=${articleName.value}`\n    \n    try {\n        const response = await fetch(url, {\n            credentials: 'include'\n        })\n        const data = await response.json();\n        console.log(\"Issue book response: \", data.message)\n        if (!data.message.success) {\n            alert(\"You already requested this book!\")\n        }\n    } catch(error) {\n        console.error(\"Failed to issue the book: \", error)\n        issueSuccess.value = false;\n    }\n}\n\n</script>"],"names":["route","useRoute","book","ref","articleName","issueSuccess","onMounted","__async","url","data","error","check_issue_url","check_issue_data","issueButtonClasses","computed","issueBook","_createVNode","Header","_createElementVNode","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_5","_toDisplayString","_hoisted_6","_hoisted_7","_hoisted_8","_cache","_createTextVNode","_createBlock","_component_Button","Footer"],"mappings":"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"}