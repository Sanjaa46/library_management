var V=Object.defineProperty,z=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var P=(i,a,r)=>a in i?V(i,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[a]=r,F=(i,a)=>{for(var r in a||(a={}))j.call(a,r)&&P(i,r,a[r]);if(C)for(var r of C(a))D.call(a,r)&&P(i,r,a[r]);return i},M=(i,a)=>z(i,I(a));var k=(i,a,r)=>new Promise((g,p)=>{var y=d=>{try{b(r.next(d))}catch(s){p(s)}},t=d=>{try{b(r.throw(d))}catch(s){p(s)}},b=d=>d.done?g(d.value):Promise.resolve(d.value).then(y,t);b((r=r.apply(i,a)).next())});import{_ as G}from"./Article-N_W0re7u.js";import{_ as H,F as J}from"./Footer-BLOyUJEW.js";import{I as K,J as A,r as v,c as m,a as O,w as U,l as u,m as n,q as N,n as c,H as W,K as w,L as h,F as q,x as B,y as X,M as $}from"./index-LNbyLESc.js";const Y={class:"max-w-[1120px] mx-auto px-4 py-12"},Z={class:"w-[1120px] my-8 mx-auto text-[24px] font-bold relative"},Q={class:"text-4xl font-bold pl-5 pt-2"},ee={key:0,class:"text-center py-12"},te={key:1},ae={key:0,class:"mx-auto mt-0 mb-[50px] grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-[20px]"},se={key:1,class:"text-center py-12"},oe={key:2,class:"flex items-center justify-center gap-2 mt-8 mb-12"},re=["disabled"],le={class:"flex gap-2"},ne={key:1,class:"px-2 py-2 text-gray-500"},ue=["onClick"],ie={key:2,class:"px-2 py-2 text-gray-500"},de=["disabled"],ye={__name:"SearchResult",setup(i){const a=K(),r=A(),g=v([]),p=v(!1),y=v(""),t=v(1),b=v(10),d=v(0),s=v(0),L=m(()=>t.value>3),E=m(()=>t.value<s.value-2),R=m(()=>t.value>4),S=m(()=>t.value<s-3),T=m(()=>{const l=[];let e=Math.max(2,t.value-2),o=Math.min(s.value-1,t.value+2);t.value<=3&&(e=2,o=Math.min(5,s.value-1)),t.value>=s.value-2&&(e=Math.max(2,s.value-4),o=s.value-1);for(let _=e;_<=o;_++)l.push(_);return l}),f=()=>k(this,null,function*(){p.value=!0;const l=`/api/method/library_management.api.search?query=${y.value}&page=${t.value}&page_size=${b.value}`;try{const o=yield(yield fetch(l,{credentials:"include",method:"GET"})).json();g.value=o.message.results,d.value=o.message.total,s.value=o.message.total_pages}catch(e){console.error("Failed to fetch books: ",e),g.value=[],d.value=0,s.value=0}finally{p.value=!1}}),x=l=>{l<1||l>s.value||(t.value=l,r.push({query:M(F({},a.query),{page:l})}),window.scrollTo({top:0,behavior:"smooth"}),f())};return O(()=>k(this,null,function*(){y.value=a.query.q||a.query.query||"a",t.value=parseInt(a.query.page)||1,U(()=>a.query,l=>{y.value=l.q||l.query||"a",t.value=parseInt(l.page)||1,f()},{deep:!0}),yield f()})),(l,e)=>(n(),u(q,null,[N(H),c("section",Y,[c("div",Z,[e[5]||(e[5]=c("div",{class:"absolute w-1 h-12 bg-[#118ab2] left-0"},null,-1)),c("h1",Q,[e[4]||(e[4]=W("Search result for ",-1)),c("i",null,"'"+w(y.value)+"'",1)])]),p.value?(n(),u("div",ee,[...e[6]||(e[6]=[c("p",{class:"text-gray-600 text-[24px]"},"Loading...",-1)])])):(n(),u("div",te,[g.value.length>0?(n(),u("div",ae,[(n(!0),u(q,null,B(g.value,o=>(n(),X(G,{key:o.article_name,book:o},null,8,["book"]))),128))])):(n(),u("div",se,[...e[7]||(e[7]=[c("p",{class:"text-gray-600 text-[24px]"},"No books found matching your search.",-1)])])),s.value>1?(n(),u("div",oe,[c("button",{onClick:e[0]||(e[0]=o=>x(t.value-1)),disabled:t.value===1,class:"px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," Previous ",8,re),c("div",le,[L.value?(n(),u("button",{key:0,onClick:e[1]||(e[1]=o=>x(1)),class:$(["px-4 py-2 rounded-lg border transition-colors",t.value===1?"bg-[#118ab2] text-white border-[#118ab2]":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])}," 1 ",2)):h("",!0),R.value?(n(),u("span",ne,"...")):h("",!0),(n(!0),u(q,null,B(T.value,o=>(n(),u("button",{key:o,onClick:_=>x(o),class:$(["px-4 py-2 rounded-lg border transition-colors",t.value===o?"bg-[#118ab2] text-white border-[#118ab2]":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])},w(o),11,ue))),128)),S.value?(n(),u("span",ie,"...")):h("",!0),E.value?(n(),u("button",{key:3,onClick:e[2]||(e[2]=o=>x(s.value)),class:$(["px-4 py-2 rounded-lg border transition-colors",t.value===s.value?"bg-[#118ab2] text-white border-[#118ab2]":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])},w(s.value),3)):h("",!0)]),c("button",{onClick:e[3]||(e[3]=o=>x(t.value+1)),disabled:t.value===s.value,class:"px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," Next ",8,de)])):h("",!0)]))]),N(J)],64))}};export{ye as default};
//# sourceMappingURL=SearchResult-D-iNEbJv.js.map
