{"version":3,"file":"Login-C6aPkJJM.js","sources":["../../../../frontend/src/pages/Login.vue"],"sourcesContent":["<template>\n  <div class=\"max-w-[100%] m-3 grid grid-cols-2 h-screen\">\n    <!-- LEFT SIDE -->\n    <div class=\"flex items-center justify-center\">\n      <Card title=\"Login to your FrappeUI App!\" class=\"w-full max-w-md bg-[#f7f4f0] z-10 px-12 py-10 rounded-xl shadow-lg\">\n        <h2 class=\"text-xl font-medium text-center mb-8\">Sign In</h2>\n        <form class=\"flex flex-col space-y-5 w-full\" @submit.prevent=\"submit\">\n          <Input\n            required\n            v-model=\"email\"\n            name=\"email\"\n            type=\"text\"\n            placeholder=\"Email\"\n          />\n          <Input\n            required\n            v-model=\"password\"\n            name=\"password\"\n            type=\"password\"\n            placeholder=\"Password\"\n          />\n          <div class=\"text-sm text-right text-gray-500 cursor-pointer hover:underline\">\n            Forgot password?\n          </div>\n          <Button :locading=\"session.login.loading\" variant=\"solid\" class=\"bg-[#007C91] text-white py-2 rounded hover:bg-[#006273] transition\">\n            Login\n          </Button>\n        </form>\n        <div class=\"text-center mt-6 text-sm\">\n          Don't have an account?\n          <a href=\"/frontend/account/signup\" class=\"text-blue-600 hover:underline\">\n            Sign up\n          </a>\n        </div>\n      </Card>\n    </div>\n\n    <!-- RIGHT SIDE: Shapes -->\n    <div class=\"relative overflow-hidden -m-10\">\n      <div class=\"bg-[#2C3E50] w-[100%] h-[120%] absolute -top-20 right-[-100px] -rotate-12 origin-top-right rounded-tl-[20px]\"></div>\n\n      <div class=\"bg-[#254B71] w-[150%] h-[150%] absolute bottom-[8px] right-[-400px] rotate-[60deg] origin-bottom-left\"></div>\n\n      <div class=\"bg-[#577592] w-[85%] h-[60%] absolute top-[-380px] right-[40px] rotate-12 rounded-bl-[20px] rounded-br-[20px]\"></div>\n    </div> \n  </div>\n\n\n</template>\n\n<script setup>\nimport { session } from '../data/session'\n\n// Session-based Authentication\nfunction submit(e) {\n  const formData = new FormData(e.target)\n\tsession.login.submit({\n    email: formData.get(\"email\"),\n\t\tpassword: formData.get(\"password\"),\n\t})\n}\n\n\n// Toke-based Authentication\nimport { ref } from 'vue';\n\nconst email = ref('')\nconst password = ref('')\nconst userType = ref('member')\n\n\n\nasync function handleLogin() {\n  if (userType.value === 'member') {\n    await loginLibraryMember()\n  } else {\n    await loginStaff()\n  }\n}\n\nasync function loginLibraryMember() {\n  console.log('Email:', email.value)\n  console.log('Timestamp:', new Date().toISOString())\n  \n  try {\n    const response = await fetch('http://localhost:8000/api/method/library_management.auth.login', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json', },\n      body: JSON.stringify({\n        email: email.value,\n        password: password.value,\n      })\n    })\n    \n    console.log('Response loginLibraryMember Status:', response.status)\n    console.log('Response OK:', response.ok)\n    \n    const data = await response.json()\n    console.log('Response Data:', data)\n\n    if (data.message && data.message.access_token) {\n      localStorage.setItem('library_token', data.message.access_token)\n      console.log('Token saved successfully to local storage')\n      console.log('Token:', data.message.access_token.substring(0, 20) + '...')\n      alert('Login successful!')\n    } else {\n      console.error('Login failed - No access token in response')\n      console.error('Response structure:', JSON.stringify(data, null, 2))\n      alert('Invalid Member login')\n    }\n  } catch (error) {\n    console.error('Login error occurred:', error)\n    console.error('Error details:', {\n      name: error.name,\n      message: error.message,\n      stack: error.stack\n    })\n    alert('Login failed. Please check console for details.')\n  }\n  \n}\n\nasync function loginStaff() {\n  try {\n    alert(\"Hello\")\n    const response = await fetch('/api/method/login', {\n      method: 'POST',\n      headers: { 'Content-type': 'application/json' },\n      body: JSON.stringify({\n        usr: email.value,\n        pwd: password.value,\n      })\n    })\n    const data = await response.json()\n    if (data.message === 'Logged In') {\n      window.location.href = '/app'\n    } else {\n      alert(\"Invalid staff login\")\n    }\n  } catch (error) {\n    console.error('Login error occurred:', error)\n    console.error('Error details:', {\n      name: error.name,\n      message: error.message,\n      stack: error.stack\n    })\n    alert('Login failed. Please check console for details.')\n  }\n\n\n}\n\n\n</script>\n"],"names":["submit","e","formData","session","email","ref","password","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_Card","_cache","_component_Input","$event","_component_Button","_unref"],"mappings":"mPAsDA,SAASA,EAAOC,EAAG,CACjB,MAAMC,EAAW,IAAI,SAASD,EAAE,MAAM,EACvCE,EAAQ,MAAM,OAAO,CAClB,MAAOD,EAAS,IAAI,OAAO,EAC7B,SAAUA,EAAS,IAAI,UAAU,CACnC,CAAE,CACF,CAMA,MAAME,EAAQC,EAAI,EAAE,EACdC,EAAWD,EAAI,EAAE,EACN,OAAAA,EAAI,QAAQ,uDAnE3B,OAAAE,EAAA,EAAAC,EA4CM,MA5CNC,EA4CM,CA1CJC,EAgCM,MAhCNC,EAgCM,CA/BJC,EA8BOC,EAAA,CA9BD,MAAM,8BAA8B,MAAM,iFAC9C,IAA6D,CAA7DC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAJ,EAA6D,KAAA,CAAzD,MAAM,sCAAsC,EAAC,UAAO,EAAA,GACxDA,EAqBO,OAAA,CArBD,MAAM,iCAAkC,WAAgBV,EAAM,CAAA,SAAA,CAAA,IAClEY,EAMEG,EAAA,CALA,SAAA,cACSX,EAAA,2CAAAA,EAAK,MAAAY,GACd,KAAK,QACL,KAAK,OACL,YAAY,gCAEdJ,EAMEG,EAAA,CALA,SAAA,cACST,EAAA,2CAAAA,EAAQ,MAAAU,GACjB,KAAK,WACL,KAAK,WACL,YAAY,mCAEdF,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAJ,EAEM,MAAA,CAFD,MAAM,iEAAiE,EAAC,qBAE7E,EAAA,GACAE,EAESK,EAAA,CAFA,SAAUC,EAAAf,CAAA,EAAQ,MAAM,QAAS,QAAQ,QAAQ,MAAM,iFAAqE,IAErI,CAAA,GAAAW,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAFqI,UAErI,EAAA,4CAEFJ,EAKM,MAAA,CALD,MAAM,4BAA0B,GAAC,0BAEpC,EAAAA,EAEI,IAAA,CAFD,KAAK,2BAA2B,MAAM,iCAAgC,WAEzE,8BAMNA,EAMM,MAAA,CAND,MAAM,kCAAgC,CACzCA,EAAgI,MAAA,CAA3H,MAAM,8GAA8G,CAAA,EAEzHA,EAAyH,MAAA,CAApH,MAAM,uGAAuG,CAAA,EAElHA,EAAiI,MAAA,CAA5H,MAAM,+GAA+G,CAAA"}