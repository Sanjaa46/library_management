var V=Object.defineProperty,z=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var P=(i,s,r)=>s in i?V(i,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[s]=r,B=(i,s)=>{for(var r in s||(s={}))j.call(s,r)&&P(i,r,s[r]);if(C)for(var r of C(s))G.call(s,r)&&P(i,r,s[r]);return i},N=(i,s)=>z(i,I(s));var k=(i,s,r)=>new Promise((p,y)=>{var v=c=>{try{b(r.next(c))}catch(a){y(a)}},t=c=>{try{b(r.throw(c))}catch(a){y(a)}},b=c=>c.done?p(c.value):Promise.resolve(c.value).then(v,t);b((r=r.apply(i,s)).next())});import{_ as D}from"./Article-sTBO6-4x.js";import{_ as H,a as J}from"./Footer-CFRdetY8.js";import{H as K,I as A,r as g,c as m,a as O,w as U,l as n,m as l,q as L,n as d,G as W,J as w,K as h,F as q,x as M,y as X,L as $}from"./index-IuHo05li.js";const Y={class:"max-w-[1120px] mx-auto px-4 py-12"},Z={class:"w-[1120px] my-8 mx-auto text-[24px] font-bold relative"},Q={key:0},ee={class:"text-4xl font-bold pl-5 pt-2"},te={key:1},se={key:0,class:"text-center py-12"},ae={key:1},oe={key:0,class:"mx-auto mt-0 mb-[50px] grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-[20px]"},re={key:1,class:"text-center py-12"},le={key:2,class:"flex items-center justify-center gap-2 mt-8 mb-12"},ne=["disabled"],ue={class:"flex gap-2"},ie={key:1,class:"px-2 py-2 text-gray-500"},de=["onClick"],ce={key:2,class:"px-2 py-2 text-gray-500"},ve=["disabled"],xe={__name:"SearchResult",setup(i){const s=K(),r=A(),p=g([]),y=g(!1),v=g(""),t=g(1),b=g(10),c=g(0),a=g(0),E=m(()=>t.value>3),F=m(()=>t.value<a.value-2),R=m(()=>t.value>4),S=m(()=>t.value<a-3),T=m(()=>{const u=[];let e=Math.max(2,t.value-2),o=Math.min(a.value-1,t.value+2);t.value<=3&&(e=2,o=Math.min(5,a.value-1)),t.value>=a.value-2&&(e=Math.max(2,a.value-4),o=a.value-1);for(let _=e;_<=o;_++)u.push(_);return u}),f=()=>k(this,null,function*(){y.value=!0;const u=`/api/method/library_management.api.search?query=${v.value}&page=${t.value}&page_size=${b.value}`;try{const o=yield(yield fetch(u,{credentials:"include",method:"GET"})).json();p.value=o.message.results,c.value=o.message.total,a.value=o.message.total_pages}catch(e){console.error("Failed to fetch books: ",e),p.value=[],c.value=0,a.value=0}finally{y.value=!1}}),x=u=>{u<1||u>a.value||(t.value=u,r.push({query:N(B({},s.query),{page:u})}),window.scrollTo({top:0,behavior:"smooth"}),f())};return O(()=>k(this,null,function*(){v.value=s.query.q||s.query.query,t.value=parseInt(s.query.page)||1,U(()=>s.query,u=>{v.value=u.q||u.query,t.value=parseInt(u.page)||1,f()},{deep:!0}),yield f()})),(u,e)=>(l(),n(q,null,[L(H),d("section",Y,[d("div",Z,[e[6]||(e[6]=d("div",{class:"absolute w-1 h-12 bg-[#118ab2] left-0"},null,-1)),v.value?(l(),n("div",Q,[d("h1",ee,[e[4]||(e[4]=W("Search result for ",-1)),d("i",null,"'"+w(v.value)+"'",1)])])):(l(),n("div",te,[...e[5]||(e[5]=[d("h1",{class:"text-4xl font-bold pl-5 pt-2"},"Books",-1)])]))]),y.value?(l(),n("div",se,[...e[7]||(e[7]=[d("p",{class:"text-gray-600 text-[24px]"},"Loading...",-1)])])):(l(),n("div",ae,[p.value.length>0?(l(),n("div",oe,[(l(!0),n(q,null,M(p.value,o=>(l(),X(D,{key:o.article_name,book:o},null,8,["book"]))),128))])):(l(),n("div",re,[...e[8]||(e[8]=[d("p",{class:"text-gray-600 text-[24px]"},"No books found matching your search.",-1)])])),a.value>1?(l(),n("div",le,[d("button",{onClick:e[0]||(e[0]=o=>x(t.value-1)),disabled:t.value===1,class:"px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," Previous ",8,ne),d("div",ue,[E.value?(l(),n("button",{key:0,onClick:e[1]||(e[1]=o=>x(1)),class:$(["px-4 py-2 rounded-lg border transition-colors",t.value===1?"bg-[#118ab2] text-white border-[#118ab2]":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])}," 1 ",2)):h("",!0),R.value?(l(),n("span",ie,"...")):h("",!0),(l(!0),n(q,null,M(T.value,o=>(l(),n("button",{key:o,onClick:_=>x(o),class:$(["px-4 py-2 rounded-lg border transition-colors",t.value===o?"bg-[#118ab2] text-white border-[#118ab2]":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])},w(o),11,de))),128)),S.value?(l(),n("span",ce,"...")):h("",!0),F.value?(l(),n("button",{key:3,onClick:e[2]||(e[2]=o=>x(a.value)),class:$(["px-4 py-2 rounded-lg border transition-colors",t.value===a.value?"bg-[#118ab2] text-white border-[#118ab2]":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])},w(a.value),3)):h("",!0)]),d("button",{onClick:e[3]||(e[3]=o=>x(t.value+1)),disabled:t.value===a.value,class:"px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," Next ",8,ve)])):h("",!0)]))]),L(J)],64))}};export{xe as default};
//# sourceMappingURL=SearchResult-DE7YzoRO.js.map
