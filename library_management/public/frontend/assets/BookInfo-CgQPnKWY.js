var p=(_,u,t)=>new Promise((n,i)=>{var c=e=>{try{a(t.next(e))}catch(o){i(o)}},m=e=>{try{a(t.throw(e))}catch(o){i(o)}},a=e=>e.done?n(e.value):Promise.resolve(e.value).then(c,m);a((t=t.apply(_,u)).next())});import{_ as b,a as f}from"./Footer-CncQ4b4I.js";import{H as h,r as d,a as k,c as y,C as g,l as w,m as B,q as v,n as s,J as l,G as r,v as C,L as j,F}from"./index-_fl2myAl.js";const I={class:"h-[810px]"},N={class:"flex w-[1120px] p-[30px] mx-auto my-10"},S={class:"flex flex-col w-[20%] items-center justify-center"},$=["src"],q={class:"text-center mt-5"},V={class:"w-[80%] ml-10"},D={class:"text-[25px] font-medium"},H={class:"flex my-5 space-x-5 text-[15px]"},A={__name:"BookInfo",setup(_){const u=h(),t=d({}),n=d(""),i=d(!1);k(()=>p(this,null,function*(){n.value=u.query.article_name;const a=`/api/method/library_management.api.book_info?article_name=${n.value}`;try{const o=yield(yield fetch(a,{credentials:"include",method:"POST",body:{article_name:n.value}})).json();t.value=o.message}catch(e){console.error("Failed to fetch books: ",e)}try{const e=`/api/method/library_management.api.has_active_issue?book=${n.value}`,x=yield(yield fetch(e,{credentials:"include"})).json();console.log("Has active issue: ",x.message),i.value=x.message}catch(e){console.error("Failed to check the user have an active issue: ",e)}}));const c=y(()=>i.value?"opacity-0":"opacity-100");function m(){return p(this,null,function*(){const a=`/api/method/library_management.api.issue_book?book=${n.value}`;try{const o=yield(yield fetch(a,{credentials:"include"})).json();console.log("Issue book response: ",o.message),o.message.success||alert("You already requested this book!")}catch(e){console.error("Failed to issue the book: ",e),i.value=!1}})}return(a,e)=>{const o=g("Button");return B(),w(F,null,[v(b),s("div",I,[e[6]||(e[6]=s("div",{class:"w-[1120px] my-8 mx-auto text-[24px] font-bold relative"},[s("div",{class:"absolute w-1 h-12 bg-[#118ab2] left-0"}),s("h1",{class:"text-4xl font-bold pl-5 pt-2"},"Book Info")],-1)),s("section",N,[s("div",S,[s("img",{src:t.value.image,class:"w-[200px] h-[300px] object-contain rounded-[5px]",alt:"book image"},null,8,$),s("p",q,l(t.value.author),1)]),s("div",V,[s("h1",D,l(t.value.article_name),1),s("div",H,[s("p",null,[e[0]||(e[0]=s("b",null,"Author: ",-1)),r(l(t.value.author),1)]),s("p",null,[e[1]||(e[1]=s("b",null,"Publisher: ",-1)),r(l(t.value.publisher),1)]),s("p",null,[e[2]||(e[2]=s("b",null,"ISBN: ",-1)),r(l(t.value.isbn),1)]),s("p",null,[e[3]||(e[3]=s("b",null,"Status: ",-1)),r(l(t.value.status),1)])]),e[5]||(e[5]=s("h1",{class:"text-[18px] font-medium"},"Description",-1)),s("p",null,l(t.value.description),1),v(o,{onClick:m,variant:"solid",class:j(["bg-[#1290b9] w-[90px] text-white my-10 rounded hover:bg-[#016475] transition",c.value])},{default:C(()=>[...e[4]||(e[4]=[r(" Issue ",-1)])]),_:1},8,["class"])])])]),v(f)],64)}}};export{A as default};
//# sourceMappingURL=BookInfo-CgQPnKWY.js.map
