var v=(d,o,a)=>new Promise((s,i)=>{var r=u=>{try{n(a.next(u))}catch(b){i(b)}},l=u=>{try{n(a.throw(u))}catch(b){i(b)}},n=u=>u.done?s(u.value):Promise.resolve(u.value).then(r,l);n((a=a.apply(d,o)).next())});import{l as f,m as x,n as e,J as c,r as p,a as $,F as k,x as D,y as B,C as h,q as g,v as C,D as N,G as V,c as _,L as P,K as L,M as S,E as T}from"./index-Cf6cM8O6.js";import{_ as q,a as F}from"./Footer-DKP4t9lR.js";const E="/assets/library_management/frontend/assets/testpro-CJgdH1j7.jpeg",O={class:"pl-[20px] space-y-4"},U={__name:"ProfileInfo",props:{user:{type:Object,required:!0}},setup(d){const o=d;return(a,s)=>(x(),f("div",null,[s[5]||(s[5]=e("h1",{class:"pl-[20px] pb-[20px] text-[30px] font-bold"},"Info",-1)),e("ul",O,[e("li",null,[s[0]||(s[0]=e("p",{class:"text-black-overlay-500"},"ID",-1)),e("p",null,c(o.user.id),1)]),e("li",null,[s[1]||(s[1]=e("p",{class:"text-black-overlay-500"},"Firstname",-1)),e("p",null,c(o.user.first_name),1)]),e("li",null,[s[2]||(s[2]=e("p",{class:"text-black-overlay-500"},"Lastname",-1)),e("p",null,c(o.user.last_name),1)]),e("li",null,[s[3]||(s[3]=e("p",{class:"text-black-overlay-500"},"Email",-1)),e("p",null,c(o.user.email),1)]),e("li",null,[s[4]||(s[4]=e("p",{class:"text-black-overlay-500"},"Phone",-1)),e("p",null,c(o.user.phone),1)])])]))}},A={class:"odd:bg-white odd:dark:bg-gray-900 even:bg-gray-50 even:dark:bg-gray-800 border-b dark:border-gray-700 border-gray-200"},J={scope:"row",class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},z={class:"px-6 py-4"},G={class:"px-6 py-4"},H={__name:"ArticleListItem",props:{book:{type:Object,required:!0}},setup(d){return(o,a)=>(x(),f("tr",A,[e("th",J,c(d.book.article),1),e("td",z,c(d.book.issue_date),1),e("td",G,c(d.book.due_date),1)]))}},K={class:"w-[90%] relative mx-auto overflow-x-auto shadow-md sm:rounded-lg"},R={class:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400"},Q={__name:"MyBooks",setup(d){const o=p([]);return $(()=>v(this,null,function*(){try{const s=yield(yield fetch("/api/method/library_management.api.my_books",{credentials:"include"})).json();o.value=s.message}catch(a){console.error("Failed to fetch books: ",a),o.value=[]}})),(a,s)=>(x(),f(k,null,[s[1]||(s[1]=e("h1",{class:"pl-[20px] pb-[20px] text-[30px] font-bold"},"My Books",-1)),e("div",K,[e("table",R,[s[0]||(s[0]=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"}," Article name "),e("th",{scope:"col",class:"px-6 py-3"}," Issued Date "),e("th",{scope:"col",class:"px-6 py-3"}," Due Date ")])],-1)),e("tbody",null,[(x(!0),f(k,null,D(o.value,i=>(x(),B(H,{key:i.article_name,book:i},null,8,["book"]))),128))])])])],64))}},W={class:"pl-[30px]"},X={__name:"ChangePassword",setup(d){const o=p(""),a=p(""),s=p("");function i(){return v(this,null,function*(){if(o.value===a.value){alert("New password must be different!");return}if(a.value!==s.value){alert("Password did not match!");return}try{const n=yield(yield fetch("/api/method/library_management.api.change_password",{credentials:"include",method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({old_password:o.value,new_password:a.value})})).json();n.message.Success?alert("Password changed succesfully!"):(console.log(n),alert("Old password is incorrect!"))}catch(r){console.log("Change password failed: ",r),console.error("Error details:",{name:r.name,message:r.message,stack:r.stack}),alert("Change password failed. Please check console for details.")}})}return(r,l)=>{const n=h("Input"),u=h("Button"),b=h("Card");return x(),f("div",W,[g(b,{title:"Login to your FrappeUI App!",class:"z-10 rounded-xl"},{default:C(()=>[l[5]||(l[5]=e("h2",{class:"text-[30px] font-bold mb-8"},"Change Password",-1)),e("form",{class:"space-y-5",onSubmit:l[3]||(l[3]=N((...m)=>r.submit&&r.submit(...m),["prevent"]))},[g(n,{required:"",modelValue:o.value,"onUpdate:modelValue":l[0]||(l[0]=m=>o.value=m),name:"current",type:"password",placeholder:"Current password",class:"w-[300px]"},null,8,["modelValue"]),g(n,{required:"",modelValue:a.value,"onUpdate:modelValue":l[1]||(l[1]=m=>a.value=m),name:"password",type:"password",class:"w-[300px]",placeholder:"New password"},null,8,["modelValue"]),g(n,{required:"",modelValue:s.value,"onUpdate:modelValue":l[2]||(l[2]=m=>s.value=m),name:"password",type:"password",class:"w-[300px]",placeholder:"Re-enter new password"},null,8,["modelValue"]),g(u,{onClick:i,variant:"solid",class:"bg-[#1290b9] text-white py-2 rounded hover:bg-[#016475] transition"},{default:C(()=>[...l[4]||(l[4]=[V(" Chnage Password ",-1)])]),_:1})],32)]),_:1})])}}},Y={class:"flex max-w-[1120px] h-[60%] mx-auto my-15"},Z={class:"w-[30%]"},ee={class:"w-[50%] m-auto text-center text-[20px] font-bold"},se={class:"text-center"},te={class:"flex flex-col items-center space-y-3 mt-5"},ae={class:"w-[70%]"},re={__name:"Profile",setup(d){const o={ProfileInfo:U,ChangePassword:X,MyBooks:Q},a=p("ProfileInfo"),s=_(()=>o[a.value]),i=p({}),r=p("John"),l=p("Doe"),n=p(!1),u=p(""),b=_(()=>n.value?"Membership":"Nonmembership"),m=_(()=>n.value?"text-green-700 bg-green-300":"text-red-700 bg-red-300"),j=_(()=>n.value?"opacity-0":"opacity-100");$(()=>v(this,null,function*(){try{const t=yield(yield fetch("/api/method/library_management.api.profile",{credentials:"include",method:"GET",headers:{"Content-Type":"application/json"}})).json();r.value=t.message.first_name,l.value=t.message.last_name,n.value=t.message.membership,i.value={id:t.message.id,first_name:t.message.first_name,last_name:t.message.last_name,phone:t.message.phone,email:t.message.email}}catch(y){console.error("Failed to fetch user info:",y)}}));function I(){return v(this,null,function*(){const w=yield(yield fetch("/api/method/library_management.api.create_checkout_session",{credentials:"include",method:"POST"})).json();console.log(w),u.value=w.message.url,window.location.href=u.value})}function M(){T.logout.submit()}return(y,t)=>(x(),f(k,null,[g(q),t[6]||(t[6]=e("div",{class:"w-[1120px] my-8 mx-auto text-[24px] font-bold relative"},[e("div",{class:"absolute w-1 h-12 bg-[#118ab2] left-0"}),e("h1",{class:"text-4xl font-bold pl-5 pt-2"},"Profile")],-1)),e("section",Y,[e("div",Z,[e("a",{onClick:t[0]||(t[0]=w=>a.value="ProfileInfo")},[...t[3]||(t[3]=[e("div",{class:"w-[250px] h-[250px] mx-auto my-5 p-[7px] border-[3px] border-[#118ab2] rounded-full"},[e("img",{class:"m-auto w-[235px] h-[235px] object-fill rounded-[50%]",src:E,alt:"profile image"})],-1)])]),e("p",ee,c(r.value+" "+l.value),1),e("div",{class:P(["w-[30%] m-auto rounded-full italic text-[10px]",m.value])},[e("p",se,[t[4]||(t[4]=e("b",null,"Status:",-1)),V(" "+c(b.value),1)])],2),e("div",te,[n.value?L("",!0):(x(),f("button",{key:0,onClick:I,class:P([" w-[215px] h-[35px] mt-5 bg-[#118ab2] hover:bg-[#016475] text-white-overlay-900 rounded-[10px]",j.value])}," Buy Membership ",2)),e("button",{onClick:t[1]||(t[1]=w=>a.value="ChangePassword")}," Change Password > "),e("button",{onClick:t[2]||(t[2]=w=>a.value="MyBooks")}," My Books > "),e("button",{onClick:M,class:"w-[215px] h-[35px] mt-5 bg-[#118ab2] hover:bg-[#016475] text-white-overlay-900 rounded-[10px]"}," Logout ")])]),t[5]||(t[5]=e("div",{class:"relative h-[475px] w-1 bg-[#118ab2] left-[-1px] top-[30px]"},null,-1)),e("div",ae,[(x(),B(S(s.value),{user:i.value},null,8,["user"]))])]),g(F)],64))}};export{re as default};
//# sourceMappingURL=Profile-SF8CrbQF.js.map
