var v=(i,l,o)=>new Promise((s,d)=>{var r=u=>{try{n(o.next(u))}catch(b){d(b)}},a=u=>{try{n(o.throw(u))}catch(b){d(b)}},n=u=>u.done?s(u.value):Promise.resolve(u.value).then(r,a);n((o=o.apply(i,l)).next())});import{l as f,m as x,n as e,J as c,r as p,a as $,F as k,x as D,y as B,C as h,q as g,v as C,D as F,G as V,c as _,L as P,M as L,E as N}from"./index-_fl2myAl.js";import{_ as S,a as T}from"./Footer-CncQ4b4I.js";const q="/assets/library_management/frontend/assets/testpro-CJgdH1j7.jpeg",E={class:"pl-[20px] space-y-4"},O={__name:"ProfileInfo",props:{user:{type:Object,required:!0}},setup(i){const l=i;return(o,s)=>(x(),f("div",null,[s[5]||(s[5]=e("h1",{class:"pl-[20px] pb-[20px] text-[30px] font-bold"},"Info",-1)),e("ul",E,[e("li",null,[s[0]||(s[0]=e("p",{class:"text-black-overlay-500"},"ID",-1)),e("p",null,c(l.user.id),1)]),e("li",null,[s[1]||(s[1]=e("p",{class:"text-black-overlay-500"},"Firstname",-1)),e("p",null,c(l.user.first_name),1)]),e("li",null,[s[2]||(s[2]=e("p",{class:"text-black-overlay-500"},"Lastname",-1)),e("p",null,c(l.user.last_name),1)]),e("li",null,[s[3]||(s[3]=e("p",{class:"text-black-overlay-500"},"Email",-1)),e("p",null,c(l.user.email),1)]),e("li",null,[s[4]||(s[4]=e("p",{class:"text-black-overlay-500"},"Phone",-1)),e("p",null,c(l.user.phone),1)])])]))}},U={class:"odd:bg-white odd:dark:bg-gray-900 even:bg-gray-50 even:dark:bg-gray-800 border-b dark:border-gray-700 border-gray-200"},A={scope:"row",class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},J={class:"px-6 py-4"},z={class:"px-6 py-4"},G={__name:"ArticleListItem",props:{book:{type:Object,required:!0}},setup(i){return(l,o)=>(x(),f("tr",U,[e("th",A,c(i.book.article),1),e("td",J,c(i.book.issue_date),1),e("td",z,c(i.book.due_date),1)]))}},H={class:"w-[90%] relative mx-auto overflow-x-auto shadow-md sm:rounded-lg"},R={class:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400"},K={__name:"MyBooks",setup(i){const l=p([]);return $(()=>v(this,null,function*(){try{const s=yield(yield fetch("/api/method/library_management.api.my_books",{credentials:"include"})).json();l.value=s.message}catch(o){console.error("Failed to fetch books: ",o),l.value=[]}})),(o,s)=>(x(),f(k,null,[s[1]||(s[1]=e("h1",{class:"pl-[20px] pb-[20px] text-[30px] font-bold"},"My Books",-1)),e("div",H,[e("table",R,[s[0]||(s[0]=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"}," Article name "),e("th",{scope:"col",class:"px-6 py-3"}," Issued Date "),e("th",{scope:"col",class:"px-6 py-3"}," Due Date ")])],-1)),e("tbody",null,[(x(!0),f(k,null,D(l.value,d=>(x(),B(G,{key:d.article_name,book:d},null,8,["book"]))),128))])])])],64))}},Q={class:"pl-[30px]"},W={__name:"ChangePassword",setup(i){const l=p(""),o=p(""),s=p("");function d(){return v(this,null,function*(){if(l.value===o.value){alert("New password must be different!");return}if(o.value!==s.value){alert("Password did not match!");return}try{const n=yield(yield fetch("/api/method/library_management.api.change_password",{credentials:"include",method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({old_password:l.value,new_password:o.value})})).json();n.message.Success?alert("Password changed succesfully!"):(console.log(n),alert("Old password is incorrect!"))}catch(r){console.log("Change password failed: ",r),console.error("Error details:",{name:r.name,message:r.message,stack:r.stack}),alert("Change password failed. Please check console for details.")}})}return(r,a)=>{const n=h("Input"),u=h("Button"),b=h("Card");return x(),f("div",Q,[g(b,{title:"Login to your FrappeUI App!",class:"z-10 rounded-xl"},{default:C(()=>[a[6]||(a[6]=e("h2",{class:"text-[30px] font-bold mb-8"},"Change Password",-1)),e("form",{class:"space-y-5",onSubmit:a[3]||(a[3]=F((...m)=>r.submit&&r.submit(...m),["prevent"]))},[g(n,{required:"",modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=m=>l.value=m),name:"current",type:"password",placeholder:"Current password",class:"w-[300px]"},null,8,["modelValue"]),g(n,{required:"",modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=m=>o.value=m),name:"password",type:"password",class:"w-[300px]",placeholder:"New password"},null,8,["modelValue"]),g(n,{required:"",modelValue:s.value,"onUpdate:modelValue":a[2]||(a[2]=m=>s.value=m),name:"password",type:"password",class:"w-[300px]",placeholder:"Re-enter new password"},null,8,["modelValue"]),a[5]||(a[5]=e("div",{class:"text-sm text-gray-500 cursor-pointer hover:underline"}," Forgot password? ",-1)),g(u,{onClick:d,variant:"solid",class:"bg-[#1290b9] text-white py-2 rounded hover:bg-[#016475] transition"},{default:C(()=>[...a[4]||(a[4]=[V(" Chnage Password ",-1)])]),_:1})],32)]),_:1})])}}},X={class:"flex max-w-[1120px] h-[60%] mx-auto my-15"},Y={class:"w-[30%]"},Z={class:"w-[50%] m-auto text-center text-[20px] font-bold"},ee={class:"text-center"},se={class:"flex flex-col items-center space-y-3 mt-5"},te={class:"w-[70%]"},ne={__name:"Profile",setup(i){const l={ProfileInfo:O,ChangePassword:W,MyBooks:K},o=p("ProfileInfo"),s=_(()=>l[o.value]),d=p({}),r=p("John"),a=p("Doe"),n=p(!1),u=p(""),b=_(()=>n.value?"Membership":"Nonmembership"),m=_(()=>n.value?"text-green-700 bg-green-300":"text-red-700 bg-red-300"),j=_(()=>n.value?"opacity-0":"opacity-100");$(()=>v(this,null,function*(){try{const t=yield(yield fetch("/api/method/library_management.api.profile",{credentials:"include",method:"GET",headers:{"Content-Type":"application/json"}})).json();r.value=t.message.first_name,a.value=t.message.last_name,n.value=t.message.membership,d.value={id:t.message.id,first_name:t.message.first_name,last_name:t.message.last_name,phone:t.message.phone,email:t.message.email}}catch(y){console.error("Failed to fetch user info:",y)}}));function I(){return v(this,null,function*(){const w=yield(yield fetch("/api/method/library_management.api.create_checkout_session",{credentials:"include",method:"POST"})).json();console.log(w),u.value=w.message.url,window.location.href=u.value})}function M(){N.logout.submit()}return(y,t)=>(x(),f(k,null,[g(S),t[6]||(t[6]=e("div",{class:"w-[1120px] my-8 mx-auto text-[24px] font-bold relative"},[e("div",{class:"absolute w-1 h-12 bg-[#118ab2] left-0"}),e("h1",{class:"text-4xl font-bold pl-5 pt-2"},"Profile")],-1)),e("section",X,[e("div",Y,[e("a",{onClick:t[0]||(t[0]=w=>o.value="ProfileInfo")},[...t[3]||(t[3]=[e("div",{class:"w-[250px] h-[250px] mx-auto my-5 p-[7px] border-[3px] border-[#118ab2] rounded-full"},[e("img",{class:"m-auto w-[235px] h-[235px] object-fill rounded-[50%]",src:q,alt:"profile image"})],-1)])]),e("p",Z,c(r.value+" "+a.value),1),e("div",{class:P(["w-[30%] m-auto rounded-full italic text-[10px]",m.value])},[e("p",ee,[t[4]||(t[4]=e("b",null,"Status:",-1)),V(" "+c(b.value),1)])],2),e("div",se,[e("button",{onClick:I,class:P([" w-[215px] h-[35px] mt-5 bg-[#118ab2] hover:bg-[#016475] text-white-overlay-900 rounded-[10px]",j.value])}," Buy Membership ",2),e("button",{onClick:t[1]||(t[1]=w=>o.value="ChangePassword")}," Change Password > "),e("button",{onClick:t[2]||(t[2]=w=>o.value="MyBooks")}," My Books > "),e("button",{onClick:M,class:"w-[215px] h-[35px] mt-5 bg-[#118ab2] hover:bg-[#016475] text-white-overlay-900 rounded-[10px]"}," Logout ")])]),t[5]||(t[5]=e("div",{class:"relative h-[475px] w-1 bg-[#118ab2] left-[-1px] top-[30px]"},null,-1)),e("div",te,[(x(),B(L(s.value),{user:d.value},null,8,["user"]))])]),g(T)],64))}};export{ne as default};
//# sourceMappingURL=Profile-DbF3LrqH.js.map
