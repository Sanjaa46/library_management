{"version":3,"file":"SearchResult-DF9jEHSw.js","sources":["../../../../frontend/src/pages/SearchResult.vue"],"sourcesContent":["<template>\n<Header></Header>\n<section class=\"max-w-[1120px] mx-auto px-4 py-12\">\n    <div class=\"w-[1120px] my-8 mx-auto text-[24px] font-bold relative\">\n        <div class=\"absolute w-1 h-12 bg-[#118ab2] left-0\"></div>\n        <div v-if=\"searchQuery\">\n            <h1 class=\"text-4xl font-bold pl-5 pt-2\">Search result for <i>'{{ searchQuery }}'</i></h1>\n        </div>\n        <div v-else=\"searchQuery\">\n            <h1 class=\"text-4xl font-bold pl-5 pt-2\">Books</h1>\n        </div>\n    </div>\n\n    <!-- Loading state -->\n    <div v-if=\"loading\" class=\"text-center py-12\">\n        <p class=\"text-gray-600 text-[24px]\">Loading...</p>\n    </div>\n\n    <!-- Result Container -->\n    <div v-else>\n        <!-- Book grid -->\n        <div v-if=\"books.length > 0\" class=\"mx-auto mt-0 mb-[50px] grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-[20px]\">\n            <Article v-for=\"book in books\" :key=\"book.article_name\" :book=\"book\" />\n        </div>\n\n        <div v-else class=\"text-center py-12\">\n            <p class=\"text-gray-600 text-[24px]\">No books found matching your search.</p>\n        </div>\n\n        <!-- Pagination -->\n        <div v-if=\"totalPages > 1\" class=\"flex items-center justify-center gap-2 mt-8 mb-12\">\n            <!-- Previous Button -->\n            <button \n                @click=\"goToPage(currentPage - 1)\"\n                :disabled=\"currentPage === 1\"\n                class=\"px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n            >\n                Previous\n            </button>\n\n            <!-- Page Numbers -->\n            <div class=\"flex gap-2\">\n                <!-- First Page -->\n                <button \n                    v-if=\"showFirstPage\"\n                    @click=\"goToPage(1)\"\n                    class=\"px-4 py-2 rounded-lg border transition-colors\"\n                    :class=\"currentPage === 1 ? 'bg-[#118ab2] text-white border-[#118ab2]' : 'bg-white text-gray-700 border-gray-300 hover:bg-gray-50'\"\n                >\n                    1\n                </button>\n\n                <!-- Left Ellipsis -->\n                <span v-if=\"showLeftEllipsis\" class=\"px-2 py-2 text-gray-500\">...</span>\n\n                <!-- Middle Pages -->\n                <button \n                    v-for=\"page in middlePages\"\n                    :key=\"page\"\n                    @click=\"goToPage(page)\"\n                    class=\"px-4 py-2 rounded-lg border transition-colors\"\n                    :class=\"currentPage === page ? 'bg-[#118ab2] text-white border-[#118ab2]' : 'bg-white text-gray-700 border-gray-300 hover:bg-gray-50'\"\n                >\n                    {{ page }}\n                </button>\n\n                <!-- Right Ellipsis -->\n                <span v-if=\"showRightEllipsis\" class=\"px-2 py-2 text-gray-500\">...</span>\n\n                <!-- Last Page -->\n                <button \n                    v-if=\"showLastPage\"\n                    @click=\"goToPage(totalPages)\"\n                    class=\"px-4 py-2 rounded-lg border transition-colors\"\n                    :class=\"currentPage === totalPages ? 'bg-[#118ab2] text-white border-[#118ab2]' : 'bg-white text-gray-700 border-gray-300 hover:bg-gray-50'\"\n                >\n                    {{ totalPages }}\n                </button>\n            </div>\n\n            <!-- Next Button -->\n            <button \n                @click=\"goToPage(currentPage + 1)\"\n                :disabled=\"currentPage === totalPages\"\n                class=\"px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n            >\n                Next\n            </button>\n        </div>\n\n    </div>\n</section>\n<Footer></Footer>\n</template>\n\n<script setup>\nimport Article from '../assets/components/Article.vue';\nimport Header from '../assets/components/Header.vue';\nimport Footer from '../assets/components/Footer.vue';\nimport { ref, onMounted, computed, watch } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\n\nconst route = useRoute();\nconst router = useRouter();\n\nconst books = ref([]);\nconst loading = ref(false);\nconst searchQuery = ref('');\nconst currentPage = ref(1)\nconst pageSize = ref(10);\nconst total = ref(0);\nconst totalPages = ref(0);\n\n// Paginition computed properties\nconst showFirstPage = computed(() => {\n    return currentPage.value > 3\n});\n\nconst showLastPage = computed(() => {\n    return currentPage.value < totalPages.value - 2\n});\n\nconst showLeftEllipsis = computed(() => {\n    return currentPage.value > 4\n});\n\nconst showRightEllipsis = computed(() => {\n    return currentPage.value < totalPages - 3\n});\n\nconst middlePages = computed(() => {\n    const pages = [];\n    let start = Math.max(2, currentPage.value - 2);\n    let end = Math.min(totalPages.value - 1, currentPage.value + 2);\n\n    // near start\n    if (currentPage.value <= 3) {\n        start = 2;\n        end = Math.min(5, totalPages.value - 1);\n    }\n\n    // near end\n    if (currentPage.value >= totalPages.value - 2) {\n        start = Math.max(2, totalPages.value - 4);\n        end = totalPages.value - 1;\n    }\n\n    for (let i = start; i <= end; i++) {\n        pages.push(i);\n    }\n\n    return pages;\n});\n\n// Fetch books \nconst fetchBooks = async () => {\n    loading.value = true;\n\n    const url = `/api/method/library_management.api.search?query=${searchQuery.value}&page=${currentPage.value}&page_size=${pageSize.value}`\n\n    try {\n        const response = await fetch(url, {\n            credentials: 'include',\n            method: 'GET',\n        });\n        const data = await response.json()\n\n        books.value = data.message.results;\n        total.value = data.message.total;\n        totalPages.value = data.message.total_pages;\n    }\n    catch (error) {\n        console.error(\"Failed to fetch books: \", error);\n        books.value = [];\n        total.value = 0;\n        totalPages.value = 0;\n    } finally {\n        loading.value = false;\n    }\n}\n\n// Go to specific page\nconst goToPage = (page) => {\n    if (page < 1 || page > totalPages.value) return;\n\n    currentPage.value = page;\n    // Update URL query params\n    router.push({\n        query: {\n            ...route.query,\n            page: page\n        }\n    });\n\n    window.scrollTo({ top: 0, behavior: 'smooth' })\n\n    fetchBooks();\n}\n\nonMounted(async () => {\n    // Get query from URL params\n    searchQuery.value = route.query.q || route.query.query;\n    currentPage.value = parseInt(route.query.page) || 1;\n\n    watch(() => route.query, (newQuery) => {\n       searchQuery.value = newQuery.q || newQuery.query;\n       currentPage.value = parseInt(newQuery.page) || 1;\n       fetchBooks();\n   }, { deep: true });\n    \n    await fetchBooks();\n});\n\n</script>"],"names":["route","useRoute","router","useRouter","books","ref","loading","searchQuery","currentPage","pageSize","total","totalPages","showFirstPage","computed","showLastPage","showLeftEllipsis","showRightEllipsis","middlePages","pages","start","end","i","fetchBooks","__async","url","data","error","goToPage","page","__spreadProps","__spreadValues","onMounted","watch","newQuery","_createVNode","Header","_createElementVNode","_hoisted_1","_hoisted_2","_createElementBlock","_hoisted_3","_hoisted_4","_toDisplayString","_hoisted_5","_cache","_openBlock","_hoisted_6","_hoisted_7","_hoisted_8","_Fragment","_renderList","book","_createBlock","Article","_hoisted_9","_hoisted_10","$event","_hoisted_11","_hoisted_12","_normalizeClass","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","Footer"],"mappings":"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"}